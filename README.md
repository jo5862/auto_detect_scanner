# auto_detect_scanner
# 프로젝트: 엔코더 5000 거리 측정기 펌웨어 (AVR 기반)

## 1. 프로젝트 개요

본 프로젝트는 AVR 마이크로컨트롤러를 사용하여 엔코더 5000을 기반으로 하는 거리 측정기 펌웨어를 개발합니다. 엔코더의 회전 정보를 읽어와 거리로 변환하고, LCD에 결과를 표시하며, 버튼을 통해 다양한 기능을 제공합니다.

## 2. 사용 기술

*   **마이크로컨트롤러:** ATmega328P (또는 유사 AVR 마이크로컨트롤러)
*   **엔코더:** 엔코더 5000
*   **LCD:** I2C 인터페이스를 사용하는 LCD (예: 16x2 LCD)
*   **프로그래밍 언어:** C
*   **개발 환경:** AVR-GCC, AVR Studio (또는 유사 IDE)
*   **통신:** I2C

## 3. 하드웨어 구성

*   **엔코더 5000:** A상, B상 출력을 AVR 마이크로컨트롤러의 인터럽트 핀 (PE4, PE5)에 연결합니다.
*   **I2C LCD:** SDA, SCL 핀을 AVR 마이크로컨트롤러의 해당 I2C 핀에 연결합니다. VCC, GND도 연결합니다.
*   **버튼:** 3개의 버튼을 AVR 마이크로컨트롤러의 디지털 입력 핀 (PD0, PD1, PD2)에 연결합니다. 풀업 저항을 사용합니다.

## 4. 코드 설명

본 프로젝트는 다음과 같은 파일로 구성됩니다.

*   `main.c`: 메인 루프, 인터럽트 핸들러 및 시스템 초기화를 담당합니다.
*   `func.c`: LCD 제어, I2C 통신, 엔코더 처리, 버튼 처리 등 주요 기능 함수들을 포함합니다.
*   `func.h`: `func.c`에 선언된 함수들의 헤더 파일입니다. 전역 변수 및 상수 정의도 포함합니다.

각 파일의 역할과 주요 기능은 다음과 같습니다.

*   **`func.h`**:  상수 정의 (LCD 주소, 핀 정의, 디바운스 딜레이 등), 전역 변수 선언, 함수 선언을 포함합니다. `PULSES_PER_REVOLUTION`과 `CIRCUMFERENCE`는 실제 엔코더와 바퀴의 사양에 맞게 수정해야 합니다.

*   **`func.c`**: I2C 통신, LCD 제어, 타이머 초기화, 버튼 초기화 및 처리, 엔코더 초기화를 담당하는 함수들을 구현합니다.

*   **`main.c`**: 인터럽트 핸들러 (타이머, 엔코더), 시스템 초기화, 메인 루프를 포함합니다. 메인 루프에서는 버튼 상태를 확인하고, 엔코더 값을 읽어와 거리를 계산하고, LCD에 결과를 표시합니다.

## 5. 설치 및 사용 방법

1.  **개발 환경 설정:** AVR-GCC 및 AVR Studio (또는 유사 IDE)를 설치합니다.
2.  **코드 컴파일 및 업로드:** `main.c`, `func.c`, `func.h` 파일을 AVR Studio (또는 유사 IDE) 프로젝트에 추가하고, 코드를 컴파일합니다. 컴파일된 HEX 파일을 AVR 프로그래머를 사용하여 ATmega328P (또는 유사 AVR 마이크로컨트롤러)에 업로드합니다.
3.  **하드웨어 연결:**
    *   엔코더 5000의 A상, B상 출력을 ATmega328P의 PE4 (INT4), PE5 (INT5) 핀에 연결합니다.
    *   I2C LCD의 SDA, SCL 핀을 ATmega328P의 SDA, SCL 핀에 연결합니다. VCC, GND도 연결합니다. I2C 풀업 저항 (일반적으로 4.7kΩ)을 SDA, SCL 핀에 연결합니다.
    *   3개의 버튼을 ATmega328P의 PD0 (BUTTON2), PD1 (BUTTON1), PD2 (BUTTON3) 핀에 연결합니다. 각 버튼에 풀업 저항을 사용하거나, AVR 마이크로컨트롤러의 내부 풀업 저항을 활성화합니다.
4.  **전원 연결:** ATmega328P에 전원을 공급합니다.
5.  **테스트:** 엔코더를 회전시켜 LCD에 표시되는 거리와 카운트 값을 확인합니다. 버튼을 눌러 리셋, 저장/불러오기, 단위 변환 기능을 테스트합니다.

## 6. 문제 해결 및 개선 사항

*   **LCD 동작 문제:** I2C LCD의 주소 (`LCD_ADDR`)가 올바른지 확인합니다. I2C 통신이 제대로 이루어지는지 확인합니다.
*   **엔코더 값 오류:** 엔코더 A상, B상 핀 연결이 올바른지 확인합니다. 엔코더의 회전 방향이 반대인 경우, `INT4_vect`와 `INT5_vect` 인터럽트 핸들러의 로직을 수정합니다.
*   **버튼 동작 문제:** 버튼 핀 연결이 올바른지 확인합니다. 풀업 저항이 제대로 연결되었는지 확인합니다. 디바운스 딜레이 (`DEBOUNCE_DELAY`) 값을 조정합니다.
*   **거리 계산 오류:** 엔코더 펄스 당 이동 거리 (`PULSES_PER_REVOLUTION`과 `CIRCUMFERENCE`) 값을 정확하게 설정합니다. 엔코더 데이터시트를 참고하여 정확한 값을 계산합니다.
*   **전력 소비:** 저전력 모드를 구현하여 전력 소비를 줄입니다. AVR 마이크로컨트롤러의 슬립 모드를 사용하고, 필요하지 않은 주변 장치의 전원을 차단합니다.

## 7. 기여 방법

본 프로젝트에 기여하고 싶으신 분은 다음과 같은 방법으로 참여할 수 있습니다.

*   **버그 수정:** 발견한 버그를 수정하고, Pull Request를 보내주세요.
*   **기능 추가:** 새로운 기능을 추가하고, Pull Request를 보내주세요.
*   **문서 개선:** 문서의 오류를 수정하거나, 내용을 보충해주세요.

## 8. 라이선스

본 프로젝트는 MIT 라이선스를 따릅니다. 자세한 내용은 `LICENSE` 파일을 참고해주세요.


